<div class="page-header">
  <h1>
    Photos
    <a href="/photos/new" class="btn btn-lg btn-success">New Photo</a>
  </h1>
</div>

<div class="row">
  <div class="col-md-8 col-md-offset-2">
    <div class="panel panel-default">
      
      <% @photos.each do |photo| %>
        <div class="panel-heading">
          <h3 class="panel-title">
            <a href="/users/<%= photo.user_id %>"> <%= photo.user.username %></a></a>
            <small>
              <%= time_ago_in_words(photo.created_at) %> ago
            </small>
          </h3>
        </div>
        
        
        
        
        <div class="panel-body">
          <a href="/photos/<%= photo.id %>">
            <img src="<%= photo.image %>" class="img-responsive">
          </a>
          
          <div>
            <!-- Logic to put in a filled heart vs empty heart -->
            <% if photo.fans.include? User.find(current_user.id).username %>
              <a href="/delete_like/<%= photo.likes.where(user_id: current_user.id) %>" class="btn btn-link">
                <i class="fa fa-heart"></i>
              </a>
            <% else %>
              <form action="/create_like" method="post">
              
                <input type="hidden" name="photo_id" value=<%= photo.id %>>

                <input type="hidden" name="user_id" value=<%= current_user.id %>>

                <button class="btn btn-link">
                  <i class="fa fa-heart-o"></i>
                </button>
              </form>
            <% end %>
              
            <!-- Now add list of user names who like photo -->
            <% photo.fans.each do |fan| %>
            <p>
                <%= fan.username %>
            <% end %>    
            like this    
            </p> 
          </div>
        
          <div>
            <!-- Add comments -->
            <% photo.comments.each do |comment| %>
            <ul>
              <li><%= comment.body %></li>
            </ul>
            <% end %>
          </div>
          
          
          <%if current_user.id == photo.user_id %>  
            <div class="btn-group btn-group-justified">
              <a href="/photos" class="btn btn-primary">
                <i class="fa fa-chevron-left"></i>
              </a>
              <a href="/photos/<%= photo.id %>/edit" class="btn btn-warning">
                <i class="fa fa-edit"></i>
              </a>
              <a href="/delete_photo/<%= photo.id %>" class="btn btn-danger" rel="nofollow">
                <i class="fa fa-trash-o"></i>
              </a>
            </div>
          <% else %>
            <div class="btn-group btn-group-justified">
              <a href="/photos" class="btn btn-primary">
                <i class="fa fa-chevron-left"></i>
              </a>
            </div>
          <%end %>  
          
        </div>
      
      <% end %>
        
    </div>
  </div>
</div>
